/*!
 * accounting.js v0.4.2, copyright 2014 Open Exchange Rates, MIT license, http://openexchangerates.github.io/accounting.js
 */
(function(v,E){function q(a){return!!(""===a||a&&a.charCodeAt&&a.substr)}function r(a){return z?z(a):"[object Array]"===A.call(a)}function w(a){return a&&"[object Object]"===A.call(a)}function x(a,b){var c;a=a||{};b=b||{};for(c in b)b.hasOwnProperty(c)&&null==a[c]&&(a[c]=b[c]);return a}function m(a,b,c){var d=[],e,k;if(!a)return d;if(B&&a.map===B)return a.map(b,c);e=0;for(k=a.length;e<k;e++)d[e]=b.call(c,a[e],e,a);return d}function t(a,b){a=Math.round(Math.abs(a));return isNaN(a)?b:a}function C(a){var b=d.settings.currency.format;"function"===typeof a&&(a=a());return q(a)&&a.match("%v")?{pos:a,neg:a.replace("-","").replace("%v","-%v"),zero:a}:a&&a.pos&&a.pos.match("%v")?a:q(b)?d.settings.currency.format={pos:b,neg:b.replace("%v","-%v"),zero:b}:b}var d={version:"0.4.1",settings:{currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3,rounding_type:"default"},number:{precision:0,grouping:3,thousand:",",decimal:".",rounding_type:"default"}}},B=Array.prototype.map,z=Array.isArray,A=Object.prototype.toString,u=d.unformat=d.parse=function(a,b){if(r(a))return m(a,function(a){return u(a,b)});a=a||0;if("number"===typeof a)return a;b=b||d.settings.number.decimal;var c=new RegExp("[^0-9-"+b+"]",["g"]),c=parseFloat((""+a).replace(/\((.*)\)/,"-$1").replace(c,"").replace(b,"."));return isNaN(c)?0:c},D=d.toFixed=function(a,b,c){b=t(b,d.settings.number.precision);c=q(c)?c:d.settings.number.rounding_type;var g=Math.pow(10,b);if("gaussian"==c){a=(d.unformat(a)*g).toFixed(8);c=Math.floor(a);var e=a-c,g=((.49999999<e&&.50000001>e?0==c%2?c:c+1:Math.round(a))/g).toFixed(b);return g}return(Math.round(d.unformat(a)*g)/g).toFixed(b)},y=d.formatNumber=d.format=function(a,b,c,g,e){if(r(a))return m(a,function(a){return y(a,b,c,g,e)});a=u(a);var k=x(w(b)?b:{precision:b,thousand:c,decimal:g,rounding_type:e},d.settings.number),h=t(k.precision),f=0>a?"-":"",l=parseInt(D(Math.abs(a||0),h,e),10)+"",p=3<l.length?l.length%3:0;return f+(p?l.substr(0,p)+k.thousand:"")+l.substr(p).replace(/(\d{3})(?=\d)/g,"$1"+k.thousand)+(h?k.decimal+D(Math.abs(a),h,e).split(".")[1]:"")},F=d.formatMoney=function(a,b,c,g,e,k,h){if(r(a))return m(a,function(a){return F(a,b,c,g,e,k)});a=u(a);h=x(w(b)?b:{symbol:b,precision:c,thousand:g,decimal:e,format:k,rounding_type:h},d.settings.currency);var f=C(h.format);return(0<a?f.pos:0>a?f.neg:f.zero).replace("%s",h.symbol).replace("%v",y(Math.abs(a),t(h.precision),h.thousand,h.decimal,h.rounding_type))};d.formatColumn=function(a,b,c,g,e,k,h){if(!a)return[];var f=x(w(b)?b:{symbol:b,precision:c,thousand:g,decimal:e,format:k,rounding_type:h},d.settings.currency),l=C(f.format),p=l.pos.indexOf("%s")<l.pos.indexOf("%v")?!0:!1,n=0;a=m(a,function(a,b){if(r(a))return d.formatColumn(a,f);a=u(a);var c=(0<a?l.pos:0>a?l.neg:l.zero).replace("%s",f.symbol).replace("%v",y(Math.abs(a),t(f.precision),f.thousand,f.decimal,f.rounding_type));c.length>n&&(n=c.length);return c});return m(a,function(a,b){return q(a)&&a.length<n?p?a.replace(f.symbol,f.symbol+Array(n-a.length+1).join(" ")):Array(n-a.length+1).join(" ")+a:a})};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=d),exports.accounting=d):"function"===typeof define&&define.amd?define([],function(){return d}):(d.noConflict=function(a){return function(){v.accounting=a;d.noConflict=E;return d}}(v.accounting),v.accounting=d)})(this);